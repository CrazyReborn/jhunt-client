{"ast":null,"code":"import _slicedToArray from\"/home/crazy_reborn/the_odin_project/jhunt-client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable react/prop-types */import React,{useEffect,useState}from'react';import ApplicationGeneral from'./ApplicationGeneral';import LoadingSpinner from'../LoadingSpinner';import ErrorPopUp from'./ErrorPopUp';import'../../styles/Applications.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Applications(_ref){var rerender=_ref.rerender;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),applications=_useState2[0],setApplications=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),errors=_useState4[0],setErrors=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loaded=_useState6[0],setLoaded=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),gotErr=_useState8[0],setGotErr=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),salaryUsrAvg=_useState10[0],setSalaryUsrAvg=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),salaryAllAvg=_useState12[0],setSalaryAllAvg=_useState12[1];function calculateAvgSalary(){var count=applications.length;var sum=0;applications.forEach(function(e){sum+=e.salary;});setSalaryUsrAvg(sum/count);}useEffect(function(){fetch(\"\".concat(process.env.REACT_APP_API_SERVER,\"applications\"),{method:'GET',credentials:'include'}).then(function(res){return res.json();}).then(function(json){if(json.applications===undefined){setErrors(json.err.errors);}else{setApplications(json.applications);}setSalaryAllAvg(json.averagesAll[0].avg);setGotErr(errors.length>0);}).catch(function(err){setErrors(['There was an error while fetching data: ',err]);}).finally(function(){setLoaded(true);});},[rerender]);useEffect(function(){calculateAvgSalary();},[loaded]);if(loaded&&applications.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"no-yet\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No applications have been added yet\"})});}return loaded?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"applications\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"application\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Company\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Position\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Salary\"}),/*#__PURE__*/_jsx(\"th\",{className:\"table-head-date\",children:\"Date\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:applications.sort(function(prev,next){return new Date(next.date)-new Date(prev.date);}).map(function(application){return/*#__PURE__*/_jsx(ApplicationGeneral,{application:application,salaryUsrAvg:salaryUsrAvg,salaryAllAvg:salaryAllAvg},application._id);})})]})}),gotErr&&/*#__PURE__*/_jsx(ErrorPopUp,{errors:errors,gotErr:gotErr,setGotErr:setGotErr})]}):/*#__PURE__*/_jsx(LoadingSpinner,{});}","map":{"version":3,"sources":["/home/crazy_reborn/the_odin_project/jhunt-client/src/components/Applications/Applications.js"],"names":["React","useEffect","useState","ApplicationGeneral","LoadingSpinner","ErrorPopUp","Applications","rerender","applications","setApplications","errors","setErrors","loaded","setLoaded","gotErr","setGotErr","salaryUsrAvg","setSalaryUsrAvg","salaryAllAvg","setSalaryAllAvg","calculateAvgSalary","count","length","sum","forEach","e","salary","fetch","process","env","REACT_APP_API_SERVER","method","credentials","then","res","json","undefined","err","averagesAll","avg","catch","finally","sort","prev","next","Date","date","map","application","_id"],"mappings":"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","sourcesContent":["/* eslint-disable react/prop-types */\nimport React, { useEffect, useState } from 'react';\nimport ApplicationGeneral from './ApplicationGeneral';\nimport LoadingSpinner from '../LoadingSpinner';\nimport ErrorPopUp from './ErrorPopUp';\nimport '../../styles/Applications.css';\n\nexport default function Applications({ rerender }) {\n  const [applications, setApplications] = useState([]);\n  const [errors, setErrors] = useState([]);\n  const [loaded, setLoaded] = useState(false);\n  const [gotErr, setGotErr] = useState(false);\n  const [salaryUsrAvg, setSalaryUsrAvg] = useState(0);\n  const [salaryAllAvg, setSalaryAllAvg] = useState(0);\n\n  function calculateAvgSalary() {\n    const count = applications.length;\n    let sum = 0;\n    applications.forEach((e) => {\n      sum += e.salary;\n    });\n    setSalaryUsrAvg(sum / count);\n  }\n\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_API_SERVER}applications`, {\n      method: 'GET',\n      credentials: 'include',\n    })\n      .then((res) => res.json())\n      .then((json) => {\n        if (json.applications === undefined) {\n          setErrors(json.err.errors);\n        } else {\n          setApplications(json.applications);\n        }\n        setSalaryAllAvg(json.averagesAll[0].avg);\n        setGotErr(errors.length > 0);\n      })\n      .catch((err) => {\n        setErrors(['There was an error while fetching data: ', err]);\n      })\n      .finally(() => {\n        setLoaded(true);\n      });\n  }, [rerender]);\n\n  useEffect(() => {\n    calculateAvgSalary();\n  }, [loaded]);\n\n  if (loaded && applications.length === 0) {\n    return (\n      <div className=\"no-yet\">\n        <p>No applications have been added yet</p>\n      </div>\n    );\n  }\n\n  return (\n    loaded\n      ? (\n        <>\n          <div className=\"applications\">\n            <table className=\"application\">\n              <thead>\n                <tr>\n                  <th>Company</th>\n                  <th>Position</th>\n                  <th>Status</th>\n                  <th>Salary</th>\n                  <th className=\"table-head-date\">Date</th>\n                </tr>\n              </thead>\n              <tbody>\n                {applications.sort((prev, next) => (new Date(next.date) - new Date(prev.date)))\n                  .map((application) => (\n                    <ApplicationGeneral\n                      key={application._id}\n                      application={application}\n                      salaryUsrAvg={salaryUsrAvg}\n                      salaryAllAvg={salaryAllAvg}\n                    />\n                  ))}\n              </tbody>\n            </table>\n          </div>\n          {gotErr && <ErrorPopUp errors={errors} gotErr={gotErr} setGotErr={setGotErr} />}\n        </>\n      )\n      : <LoadingSpinner />\n  );\n}\n"]},"metadata":{},"sourceType":"module"}